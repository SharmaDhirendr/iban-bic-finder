<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IBAN to BIC Finder</title>
  <meta name="description" content="Find BIC/SWIFT codes from IBAN numbers instantly"/>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’³</text></svg>">
  
  <!-- ==================== STYLES ==================== -->
  <style>
    /* CSS Variables for easy theming */
    :root {
      --primary: #3b82f6;
      --primary-dark: #2563eb;
      --success: #10b981;
      --error: #ef4444;
      --text: #1f2937;
      --text-light: #6b7280;
      --border: #e5e7eb;
      --bg: #f9fafb;
      --card-bg: #ffffff;
    }

    /* Reset and base styles */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      padding: 1.5rem;
      line-height: 1.6;
    }

    /* Main container */
    .container {
      max-width: 600px;
      margin: 2rem auto;
      background: var(--card-bg);
      border-radius: 1rem;
      padding: 2rem;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    /* Header section */
    .header {
      text-align: center;
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid var(--border);
    }

    h1 {
      font-size: 1.75rem;
      font-weight: 800;
      margin-bottom: 0.75rem;
      color: var(--text);
    }

    .description {
      color: var(--text-light);
      font-size: 0.95rem;
      line-height: 1.5;
      max-width: 500px;
      margin: 0 auto;
    }

    /* Input section */
    .input-section {
      margin-bottom: 1.5rem;
    }

    label {
      display: block;
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--text);
    }

    input {
      width: 100%;
      padding: 0.875rem 1rem;
      font-size: 1rem;
      border: 2px solid var(--border);
      border-radius: 0.5rem;
      transition: all 0.2s;
      font-family: 'Courier New', monospace;
      letter-spacing: 0.5px;
    }

    input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .hint {
      color: var(--text-light);
      font-size: 0.85rem;
      margin-top: 0.5rem;
    }

    /* Button */
    .find-button {
      width: 100%;
      padding: 1rem;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 0.5rem;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      margin-bottom: 1.5rem;
    }

    .find-button:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }

    .find-button:active {
      transform: translateY(0);
    }

    /* Error message */
    .error-message {
      display: none;
      background: #fef2f2;
      border: 1px solid #fecaca;
      color: var(--error);
      padding: 0.875rem;
      border-radius: 0.5rem;
      margin-bottom: 1rem;
      font-size: 0.9rem;
    }

    .error-message.show {
      display: block;
      animation: slideDown 0.3s ease-out;
    }

    /* Result section */
    .result-section {
      display: none;
      background: #ecfdf5;
      border: 2px solid #a7f3d0;
      border-radius: 0.75rem;
      padding: 1.5rem;
      margin-top: 1.5rem;
    }

    .result-section.show {
      display: block;
      animation: slideDown 0.3s ease-out;
    }

    .result-row {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin: 0.75rem 0;
      padding: 0.5rem 0;
    }

    .result-label {
      min-width: 80px;
      font-weight: 600;
      color: #065f46;
      font-size: 0.9rem;
    }

    .result-value {
      flex: 1;
      font-family: 'Courier New', monospace;
      font-size: 1rem;
      color: var(--text);
    }

    .copy-button {
      background: var(--success);
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }

    .copy-button:hover {
      background: #059669;
      transform: translateY(-1px);
    }

    .copy-button:active {
      transform: translateY(0);
    }

    .copy-button.copied {
      background: #059669;
      animation: pulse 0.3s ease-out;
    }

    /* Footer */
    .footer {
      text-align: center;
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 1px solid var(--border);
      color: var(--text-light);
      font-size: 0.85rem;
    }

    /* Animations */
    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.05);
      }
    }

    /* Responsive design */
    @media (max-width: 640px) {
      .container {
        padding: 1.5rem;
      }
      
      h1 {
        font-size: 1.5rem;
      }
      
      .result-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
      }
      
      .result-label {
        min-width: auto;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    
    <!-- ==================== HEADER SECTION ==================== -->
    <div class="header">
      <h1>ðŸ’³ IBAN to BIC Finder</h1>
      <p class="description">
        Simply paste your IBAN (International Bank Account Number) below, and we'll instantly find the corresponding BIC/SWIFT code for you. All processing happens locally on your device - your data never leaves your browser.
      </p>
    </div>

    <!-- ==================== INPUT SECTION ==================== -->
    <div class="input-section">
      <label for="iban">Enter your IBAN</label>
      <input 
        type="text" 
        id="iban" 
        placeholder="e.g. DE89 3704 0044 0532 0130 00"
        autocomplete="off"
        autocapitalize="none"
        spellcheck="false"
      />
      <p class="hint">âœ“ Works offline â€¢ No data is sent to any server</p>
    </div>

    <!-- ==================== FIND BUTTON ==================== -->
    <button class="find-button" id="findBtn">Find BIC Code</button>

    <!-- ==================== ERROR MESSAGE ==================== -->
    <div class="error-message" id="errorMessage"></div>

    <!-- ==================== RESULT SECTION ==================== -->
    <div class="result-section" id="resultSection">
      <div class="result-row">
        <span class="result-label">BIC Code:</span>
        <span class="result-value" id="bicValue">-</span>
        <button class="copy-button" id="copyBtn">Copy</button>
      </div>
      <div class="result-row">
        <span class="result-label">Bank Name:</span>
        <span class="result-value" id="bankValue">-</span>
      </div>
      <div class="result-row">
        <span class="result-label">Country:</span>
        <span class="result-value" id="countryValue">-</span>
      </div>
    </div>

    <!-- ==================== FOOTER ==================== -->
    <div class="footer">
      Free â€¢ Secure â€¢ Private
    </div>
  </div>

  <!-- ==================== JAVASCRIPT ==================== -->
  <script>
    // ==================== BANK RULES DATA ====================
    // Add your bank rules here in this format:
    // "CountryCode + BankCode": { bic: "BICCODE", bank: "Bank Name", country: "Country" }
    
   const bankRules = {
  // --- Germany ---
  "DE3704": { bic: "COBADEFFXXX", bank: "Commerzbank", country: "Germany" },
  "DE5001": { bic: "DEUTDEFFXXX", bank: "Deutsche Bank", country: "Germany" },

  // --- Netherlands ---
  "NLINGB": { bic: "INGBNL2A", bank: "ING Bank", country: "Netherlands" },
  "NLABNA": { bic: "ABNANL2A", bank: "ABN AMRO", country: "Netherlands" },

  // --- France ---
  "FR2004": { bic: "BNPAFRPPXXX", bank: "BNP Paribas", country: "France" },
  "FR3000": { bic: "SOGEFRPPXXX", bank: "SociÃ©tÃ© GÃ©nÃ©rale", country: "France" },

  // --- United Kingdom ---
  "GBNWBK": { bic: "NWBKGB2L", bank: "NatWest", country: "United Kingdom" },
  "GBBARC": { bic: "BARCGB22", bank: "Barclays", country: "United Kingdom" },

  // --- Spain ---
  "ES2100": { bic: "CAIXESBBXXX", bank: "CaixaBank", country: "Spain" },
  "ES0182": { bic: "BBVAESMMXXX", bank: "BBVA", country: "Spain" }
};

// Example test function to check logic (e.g., match IBAN prefix and log details)
function lookupBank(ibanPrefix) {
  const rule = bankRules[ibanPrefix];
  if (rule) {
    console.log(`Found: ${rule.bank} (${rule.country}) - BIC: ${rule.bic}`);
    return rule;
  } else {
    console.log('No match found.');
    return null;
  }
}

// Test it
lookupBank("FR56"); // Should log BNP Paribas details
lookupBank("ZZ99"); // Should log 'No match found.'
      // Add bank rules here - example format:
      // "DE3704": { bic: "COBADEFFXXX", bank: "Commerzbank", country: "Germany" },
      // "FR142004": { bic: "BNPAFRPPXXX", bank: "BNP Paribas", country: "France" },
    

    // ==================== DOM ELEMENTS ====================
    const ibanInput = document.getElementById("iban");
    const findBtn = document.getElementById("findBtn");
    const errorMessage = document.getElementById("errorMessage");
    const resultSection = document.getElementById("resultSection");
    const bicValue = document.getElementById("bicValue");
    const bankValue = document.getElementById("bankValue");
    const countryValue = document.getElementById("countryValue");
    const copyBtn = document.getElementById("copyBtn");

    // ==================== LOCAL STORAGE FUNCTIONS ====================
    // Remember the last IBAN entered by user
    function restoreLastIBAN() {
      const lastIBAN = localStorage.getItem('lastIBAN');
      if (lastIBAN) {
        ibanInput.value = lastIBAN;
      }
    }

    function saveLastIBAN() {
      localStorage.setItem('lastIBAN', ibanInput.value);
    }

    // ==================== VALIDATION FUNCTIONS ====================
    // Check if the input looks like a valid IBAN format
    function isValidIBANFormat(iban) {
      const cleaned = iban.replace(/\s+/g, '').toUpperCase();
      // IBAN format: 2 letters (country) + 2 digits (check) + up to 30 alphanumeric
      return /^[A-Z]{2}[0-9]{2}[A-Z0-9]{1,30}$/.test(cleaned);
    }

    // ==================== ERROR HANDLING ====================
    function showError(message) {
      errorMessage.textContent = message;
      errorMessage.classList.add('show');
      resultSection.classList.remove('show');
    }

    function hideError() {
      errorMessage.classList.remove('show');
      errorMessage.textContent = '';
    }

    // ==================== BANK LOOKUP FUNCTION ====================
    // Find the best matching bank rule (longest match wins)
    function findBankInfo(iban) {
      const country = iban.substring(0, 2);
      const bankCode = iban.substring(4, 8);
      const searchKey = country + bankCode;

      // Find the longest matching rule
      let bestMatch = null;
      let bestMatchLength = 0;

      for (const ruleKey in bankRules) {
        if (searchKey.startsWith(ruleKey) || ruleKey.startsWith(searchKey)) {
          if (ruleKey.length > bestMatchLength) {
            bestMatch = bankRules[ruleKey];
            bestMatchLength = ruleKey.length;
          }
        }
      }

      return bestMatch;
    }

    // ==================== MAIN FIND BIC FUNCTION ====================
    function findBIC() {
      // Get and clean the input
      const rawInput = ibanInput.value || '';
      const cleanedIBAN = rawInput.replace(/\s+/g, '').toUpperCase();

      // Validate input
      if (!cleanedIBAN) {
        showError('Please enter an IBAN number.');
        return;
      }

      if (cleanedIBAN.length < 15 || !isValidIBANFormat(cleanedIBAN)) {
        showError('Please enter a valid IBAN format. Example: DE89 3704 0044 0532 0130 00');
        return;
      }

      // Clear any previous errors
      hideError();

      // Try to find bank information
      const bankInfo = findBankInfo(cleanedIBAN);

      if (bankInfo) {
        // Success - display the results
        bicValue.textContent = bankInfo.bic;
        bankValue.textContent = bankInfo.bank;
        countryValue.textContent = bankInfo.country;
        resultSection.classList.add('show');
      } else {
        // Bank not found in our database
        showError('Sorry, we are unable to find BIC information for this IBAN. The bank may not be in our database yet.');
      }
    }

    // ==================== COPY TO CLIPBOARD FUNCTION ====================
    function copyBICToClipboard() {
      const bicText = bicValue.textContent;
      
      if (!bicText || bicText === '-') {
        return;
      }

      // Use clipboard API to copy
      navigator.clipboard.writeText(bicText).then(() => {
        // Show "Copied!" feedback
        const originalText = copyBtn.textContent;
        copyBtn.textContent = 'Copied!';
        copyBtn.classList.add('copied');

        // Reset button after 1.5 seconds
        setTimeout(() => {
          copyBtn.textContent = originalText;
          copyBtn.classList.remove('copied');
        }, 1500);
      }).catch(() => {
        // Fallback if clipboard API fails
        showError('Failed to copy. Please copy the BIC code manually.');
      });
    }

    // ==================== EVENT LISTENERS ====================
    // Restore last IBAN on page load
    restoreLastIBAN();

    // Save IBAN to localStorage as user types
    ibanInput.addEventListener('input', saveLastIBAN);

    // Allow pressing Enter to trigger search
    ibanInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        findBIC();
      }
    });

    // Find button click
    findBtn.addEventListener('click', findBIC);

    // Copy button click
    copyBtn.addEventListener('click', copyBICToClipboard);
  </script>
</body>
</html>
